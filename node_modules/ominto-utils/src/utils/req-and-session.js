'use strict';

var _ = require('lodash');
var uuid = require('node-uuid');

function getReqIdFromTrigger (trigger) {
  if (trigger && _.isArray(trigger) && trigger.length > 0) {
    return getReqId(trigger[0].req_id);
  } else {
    return uuid.v4();
  }
}

function getReqId (reqId) {
  if (reqId && _.isString(reqId) && !_.isEmpty(reqId)) {
    reqId = reqId + ', ' + uuid.v4();
  } else {
    reqId = uuid.v4();
  }
  return reqId;
}

function getSessionIdFromTrigger (trigger) {
  if (trigger && _.isArray(trigger) && trigger.length > 0) {
    return getSessionId(trigger[0].session_id);
  } else {
    return uuid.v4();
  }
}

function getSessionId (sessionId) {
  if (!sessionId || !_.isString(sessionId) || _.isEmpty(sessionId)) {
    sessionId = uuid.v4();
  }
  return sessionId;
}

module.exports = {
  getReqId: getReqId,
  getSessionId: getSessionId,
  getReqIdFromTrigger: getReqIdFromTrigger,
  getSessionIdFromTrigger: getSessionIdFromTrigger
};
