'use strict';
var utils = require('./src/utils.js');

var o_configs = {
  data_api: {
    url: 'http://localhost:8090',
    auth: {
      user: 'foo',
      password: 'foo'
    }
  }
};

var impls = {
  'the:only:one': function * () {
    return;
  }
};

var handler = utils.kinesisHandler.handler(o_configs, impls);

handler({
  'Records': [{
    'kinesis': {
      'partitionKey': 'partitionKey-3',
      'kinesisSchemaVersion': '1.0',
      'data': 'eyJ0eXBlIjoibWVyY2hhbnQ6YWRkOmltcGFjdHJhZGl1cyIsImRhdGEiOnsiQWR2ZXJ0aXNlcklkIjoiMTMxOTQzIiwiQWR2ZXJ0aXNlck5hbWUiOiJpY3JhY2tlZCIsIkFkdmVydGlzZXJVcmwiOiJodHRwOi8vd3d3LmljcmFja2VkLmNvbSIsIkNhbXBhaWduSWQiOiIzMjEyIiwiQ2FtcGFpZ25OYW1lIjoiaUNyYWNrZWQiLCJDYW1wYWlnbkxvZ29VcmkiOiIvZGlzcGxheS1sb2dvLXZpYS1jYW1wYWlnbi8zMjEyLmdpZiIsIkluc2VydGlvbk9yZGVyU3RhdHVzIjoiQWN0aXZlIiwiSW5zZXJ0aW9uT3JkZXJVcmkiOiIiLCJUcmFja2luZ0xpbmsiOiJodHRwOi8vaWNyYWNrZWQuZXZ5eS5uZXQvYy8xNTU1MjAvMTg3MTExLzMyMTIiLCJBbGxvd3NEZWVwbGlua2luZyI6InRydWUiLCJVcmkiOiIvTWVkaWFwYXJ0bmVycy9JUkRITHFIcFFZNzkxNTU1MjBuZ0oyOEQ5ZE1HVFZaSkExL0NhbXBhaWducy8zMjEyLmpzb24ifX0=',
      'sequenceNumber': '49545115243490985018280067714973144582180062593244200961'
    },
    'eventSource': 'aws:kinesis',
    'eventID': 'shardId-000000000000:49545115243490985018280067714973144582180062593244200961',
    'invokeIdentityArn': 'arn:aws:iam::EXAMPLE',
    'eventVersion': '1.0',
    'eventName': 'aws:kinesis:record',
    'eventSourceARN': 'arn:aws:kinesis:EXAMPLE',
    'awsRegion': 'us-east-1'
  }]
}, {
  done: function () {
  }
});

new Buffer(JSON.stringify({
  type: 'merchant:add:impactradius',
  data: {
    'AdvertiserId': '131943',
    'AdvertiserName': 'icracked',
    'AdvertiserUrl': 'http://www.icracked.com',
    'CampaignId': '3212',
    'CampaignName': 'iCracked',
    'CampaignLogoUri': '/display-logo-via-campaign/3212.gif',
    'InsertionOrderStatus': 'Active',
    'InsertionOrderUri': '',
    'TrackingLink': 'http://icracked.evyy.net/c/155520/187111/3212',
    'AllowsDeeplinking': 'true',
    'Uri': '/Mediapartners/IRDHLqHpQY79155520ngJ28D9dMGTVZJA1/Campaigns/3212.json'
  }
})).toString('base64');
